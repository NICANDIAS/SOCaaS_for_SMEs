<ossec_config>

  <!-- Global basics -->
  <global>
    <jsonout_output>yes</jsonout_output>
    <alerts_log>yes</alerts_log>
    <logall>no</logall>
    <email_notification>no</email_notification>
  </global>

  <!-- Agent <-> Manager (required for data to flow) -->
  <remote>
    <!-- secure = OSSEC protocol over TLS -->
    <connection>secure</connection>
    <port>1514</port>
    <protocol>tcp</protocol>
  </remote>

  <!-- Agent enrollment API (used by agent-auth.exe) -->
  <auth>
    <disabled>no</disabled>
    <port>1515</port>
    <use_password>no</use_password>
    <force_insert>yes</force_insert>
    <purge>no</purge>
  </auth>

  <!-- Rules/Decoders + threat lists (stops the “could not be loaded” warnings) -->
  <ruleset>
    <decoder_dir>ruleset/decoders</decoder_dir>
    <rule_dir>ruleset/rules</rule_dir>

    <!-- built-in lists referenced by default rules -->
    <list>etc/lists/audit-keys</list>
    <list>etc/lists/malicious-ip</list>
    <list>etc/lists/malicious-domains</list>
    <list>etc/lists/malicious-hashes</list>
  </ruleset>

  <!-- Vulnerability detector (manager-side) -->
  <vulnerability-detector>
    <enabled>yes</enabled>
    <interval>12h</interval>
    <ignore_time>6h</ignore_time>

    <!-- Ubuntu feed (keep if your Linux VM is Ubuntu) -->
    <provider name="canonical">
      <enabled>yes</enabled>
      <os>ubuntu</os>
    </provider>

    <!-- Windows Updates feed -->
    <provider name="msu">
      <enabled>yes</enabled>
    </provider>

    <!-- NVD enrichment -->
    <provider name="nvd">
      <enabled>yes</enabled>
      <update_interval>12h</update_interval>
    </provider>

    <!-- Add this block too if you actually have Debian -->
    <!--
    <provider name="debian">
      <enabled>yes</enabled>
      <os>debian</os>
    </provider>
    -->
  </vulnerability-detector>

  <!-- keep logs plain text; JSON is already written to alerts.json -->
  <logging>
    <log_format>plain</log_format>
  </logging>

</ossec_config>

